/** editor.wxss **/
page {
  height: 100%;
  width: 100%;
  background-color: #f1f5f9; /* Workspace default bg */
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
  overflow: hidden; /* Prevent scrolling */
}

.container {
  width: 100vw;
  height: 100vh;
  position: relative;
  overflow: hidden;
}

/* Workspace */
/* .workspace class wrapped content in index, but here .container wraps it directly or we just use styles directly */
/* In wxml I removed .workspace wrapper and used .container directly? No, looking at my wxml write:
<view class="container">
  <view class="gesture-area" ...
The original had <view class="workspace"> inside container.
My new wxml has <view class="container"> then <view class="gesture-area">.
So the .gesture-area is direct child of .container.
Current CSS .gesture-area is just width/height 100%.

Let's just copy the workspace styles.
*/

.gesture-area {
  width: 100%;
  height: 100%;
  overflow: hidden;
}

.transform-container {
  transform-origin: 0 0;
  will-change: transform;
}

.target-image {
  display: block;
}

/* Line Elements */
.line-group {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
}

.visual-line {
  position: absolute;
  height: 0;
  transform-origin: 0 50%;
  display: flex;
  align-items: center;
  pointer-events: auto;
}

.line-stroke {
  width: 100%;
  box-shadow: 0 1px 3px rgba(0,0,0,0.15);
}

/* Arrows */
.arrow {
  width: 0;
  height: 0;
  border-style: solid;
  filter: drop-shadow(0 1px 2px rgba(0,0,0,0.15));
}

.arrow.start {
  border-color: transparent transparent transparent transparent;
  margin-right: -1px;
}

.arrow.end {
  border-color: transparent transparent transparent transparent;
  margin-left: -1px;
}

/* Tag */
.line-tag {
  position: absolute;
  left: 50%;
  top: -4px; 
  transform: translate(-50%, -100%);
  background-color: rgba(255, 255, 255, 0.95);
  color: #1e293b;
  padding: 2px 6px;
  border-radius: 4px;
  font-weight: 700;
  white-space: nowrap;
  pointer-events: auto;
  z-index: 20;
  box-shadow: 0 4px 12px rgba(0,0,0,0.08);
  border: 1px solid rgba(0,0,0,0.05);
  transition: all 0.2s ease;
}

.line-group.selected .line-tag {
  border-color: #3b82f6;
  color: #3b82f6;
  background-color: #fff;
  transform: translate(-50%, -100%) scale(1.05);
}

/* Anchors */
.anchor-circle {
  position: absolute;
  width: 50px;
  height: 50px;
  border-radius: 50%;
  background-color: rgb(255 198 46 / 0.3);
  border: 2px solid #FFC62E;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
  transform: translate(-50%, -50%);
  z-index: 30;
  pointer-events: auto;
  transition: transform 0.1s ease;
}

.anchor-circle:active {
  transform: translate(-50%, -50%) scale(1.2);
}

/* UI Overlay (Add Button) */
.ui-overlay {
  position: absolute;
  bottom: 100px;
  right: 16px;
  z-index: 100;
}

.btn-action {
  width: 52px;
  height: 52px;
  border-radius: 8px;
  display: flex;
  justify-content: center;
  align-items: center;
  font-size: 16px;
  font-weight: 600;
  box-shadow: 0 10px 25px rgba(59, 130, 246, 0.3);
  transition: all 0.2s ease;
}

.btn-action:active {
  transform: scale(0.95);
}

.btn-add {
  background-color: #3b82f6;
  color: #fff;
  flex-direction: column;
  padding: 0; 
}

.btn-icon {
  width: 24px;
  height: 24px;
  margin-bottom: 2px;
  filter: brightness(0) invert(1);
}

.btn-text {
  font-size: 12px;
  line-height: 1.2;
}

/* Top Controls */
.top-left-controls {
  position: absolute;
  top: 8px;
  left: 16px;
  z-index: 100;
}



.top-controls {
  background-color: #fff;
  position: absolute;
  top: 0; 
  left: 0;
  width: 100%;
  display: flex;
  justify-content: space-between;
  padding: 4px 16px 4px 16px; 
  box-sizing: border-box;
  z-index: 100;
  gap: 12px; 
}

.btn-mini {
  padding: 8px 0; /* Remove horizontal padding since it's flex */
  border-radius: 8px;
  font-size: 14px;
  font-weight: 600;
  box-shadow: none;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s ease;
  border: none;
  height: 50px; /* Fixed height for icon+text buttons */
  flex: 1; /* Distribute equally */
}

.btn-mini:active {
  transform: scale(0.95);
}

.btn-mini.disabled {
  opacity: 1;
  pointer-events: none;
  background-color: transparent;
  color: #94a3b8;
  box-shadow: none;
  border-color: transparent;
}

.icon-wrapper {
  width: 20px;
  height: 20px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.btn-mini.disabled .icon-wrapper image {
  /* Filter for #94a3b8 */
  filter: invert(68%) sepia(12%) saturate(478%) hue-rotate(176deg) brightness(91%) contrast(86%) !important;
}

.btn-back {
  background-color: rgba(255, 255, 255, 0.9);
  color: #334155;
  backdrop-filter: blur(8px);
}

.btn-save {
  background-color: #3b82f6;
  color: #fff;
  box-shadow: 0 4px 12px rgba(59, 130, 246, 0.2);
}

.btn-delete {
  background-color: transparent;
  color: #ef4444; /* Red Text */
  box-shadow: none;
  flex-direction: column;
  height: auto;
  padding: 4px 12px;
  gap: 2px;
}

.btn-icon-delete {
  width: 100%;
  height: 100%;
  display: block;
  /* Filter for #ef4444 by default, handled if svg is black */
  filter: invert(33%) sepia(97%) saturate(1837%) hue-rotate(340deg) brightness(98%) contrast(92%);
}

.btn-text-delete {
  font-size: 11px;
  line-height: 1.2;
}

/* Disabled state specific for delete button if needed, but generic .disabled handles opacity/pointer-events */
/* We might need to ensure icon color behaves if it's an SVG. SVG color is usually controlled by src unless it's a mask. 
   If it's an image src, we can't easily recolor it with CSS color property unless we use filter.
   The user said "icon and text normal state color is red". 
   If it's a black SVG, we might need filter to make it red? Or assumes the SVG is red? 
   Let's assume the SVG might need coloring. If it's standard black SVG, we use filter.
   To be safe, let's use a filter to make it red if it's not already.
   Red hex #ef4444.
   Filter for #ef4444: invert(36%) sepia(86%) saturate(2250%) hue-rotate(336deg) brightness(97%) contrast(93%);
   
   However, user just said "icon and text... color is red". 
   I will set text color red. For icon, I'll try to apply a filter if it's not red, but let's default to no filter first or check if I can just use text.
   Wait, "icon我放在本地了... 正常状态的颜色为红色". This might mean "I want you to make it red" OR "It is red".
   Given "垃圾桶2.svg" it's likely a standard icon. I will add a filter class.
*/
.btn-delete .btn-icon-delete {
  /* Make it red */ 
  /* Generating a red filter for #ef4444 approximately */
  filter: invert(33%) sepia(97%) saturate(1837%) hue-rotate(340deg) brightness(98%) contrast(92%);
}

/* .btn-delete.disabled is covered by .btn-mini.disabled image now */

.btn-layer {
  background-color: transparent;
  color: #334155;
  border: none;
  flex-direction: column;
  height: auto;
  padding: 4px 12px;
  gap: 2px;
}

.btn-icon-layer {
  width: 100%;
  height: 100%;
  display: block;
  /* Filter for #334155 */
  filter: invert(21%) sepia(30%) saturate(366%) hue-rotate(173deg) brightness(97%) contrast(93%);
}

.btn-text {
  font-size: 11px;
  line-height: 1.2;
}

.btn-save-vertical {
  background-color: transparent;
  color: #3b82f6;
  box-shadow: none;
  flex-direction: column;
  height: auto;
  padding: 4px 12px;
  gap: 2px;
}

.btn-save-vertical .btn-icon-save {
  filter: invert(35%) sepia(76%) saturate(1478%) hue-rotate(203deg) brightness(101%) contrast(96%);
}

.btn-icon-save {
  width: 940%;
  height: 94%;
  display: block;
}

.btn-text-save {
  font-size: 11px;
  line-height: 1.2;
}

/* Edit Toolbar */
.edit-toolbar {
  position: absolute;
  bottom: 0;
  left: 0;
  width: 100%;
  background-color: rgba(255, 255, 255, 1);
  backdrop-filter: blur(12px);
  padding: 16px;
  padding-bottom: 40px;
  border-top-left-radius: 24px;
  border-top-right-radius: 24px;
  display: flex;
  flex-direction: column;
  gap: 12px;
  z-index: 110;
  box-sizing: border-box;
  box-shadow: 0 -10px 40px rgba(0,0,0,0.05);
}

.tool-section {
  display: flex;
  align-items: center;
  gap: 16px;
}

.tool-label {
  flex-shrink:0;
  color: #64748b;
  font-size: 14px;
  font-weight: 500;
  width: 30px;
}

.btn-circle {
  width: 40px;
  height: 40px;
  border-radius: 14px;
  background-color: #f1f5f9;
  color: #334155;
  display: flex;
  justify-content: center;
  align-items: center;
  font-size: 22px;
  font-weight: 500;
  transition: all 0.2s ease;
}

.btn-circle:active {
  background-color: #e2e8f0;
}

.color-scroll {
  display: flex;
  white-space: nowrap;
  height: 40px;
}

.color-item {
  display: inline-block;
  flex-shrink: 0;
  width: 36px;
  height: 36px;
  border-radius: 50%;
  margin-right: 12px;
  border: 2px solid rgba(0,0,0,0.05);
  box-shadow: 0 2px 6px rgba(0,0,0,0.05);
  transition: transform 0.2s ease;
}

.color-item:active {
  transform: scale(0.9);
}

/* Modal */
.modal-mask {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(4px);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 200;
}

.modal-content {
  width: 80%;
  background-color: #fff;
  border-radius: 24px;
  padding: 24px;
  box-shadow: 0 20px 50px rgba(0,0,0,0.1);
}

.modal-title {
  font-size: 18px;
  font-weight: 600;
  color: #1e293b;
  margin-bottom: 20px;
  text-align: center;
  display: block;
}

.modal-input {
  width: 100%;
  height: 48px;
  background-color: #f8fafc;
  border-radius: 12px;
  padding: 0 16px;
  box-sizing: border-box;
  font-size: 16px;
  color: #334155;
  margin-bottom: 24px;
  border: 1px solid #e2e8f0;
}

.modal-footer {
  display: flex;
  justify-content: space-between;
  gap: 16px;
}

.modal-btn {
  flex: 1;
  height: 48px;
  border-radius: 14px;
  display: flex;
  justify-content: center;
  align-items: center;
  font-size: 16px;
  font-weight: 600;
}

.modal-btn.cancel {
  background-color: #f1f5f9;
  color: #64748b;
}

.modal-btn.confirm {
  background-color: #3b82f6;
  color: #fff;
  box-shadow: 0 4px 12px rgba(59, 130, 246, 0.25);
}

/* Hidden Canvas */
.export-canvas {
  position: fixed;
  left: 10000px;
  top: 0;
}

/* Tag Edit Styles */
.input-group {
  flex: 1;
  display: flex;
  align-items: center;
  background-color: #ebf1f7;
  border-radius: 12px;
  padding: 4px;
  padding-left: 12px;
  padding-right: 12px;
  min-height: 36px;
}

.tag-input {
  flex: 1;
  height: 36px;
  font-size: 16px;
  color: #334155;
}

.unit-toggle {
  display: flex;
  background-color: #e2e8f0;
  border-radius: 8px;
  padding: 3px;
  margin-left: 8px;
  gap: 4px;
}

.unit-btn {
  padding: 4px 8px;
  font-size: 13px;
  font-weight: 600;
  color: #64748b;
  border-radius: 6px;
  transition: all 0.2s ease;
  min-width: 24px;
  text-align: center;
}

.unit-btn.active {
  background-color: #fff;
  color: #3b82f6;
  box-shadow: 0 1px 2px rgba(0,0,0,0.1);
}

/* Hit Area for easier selection */
.hit-area {
  position: absolute;
  top: 50%;
  left: 0;
  width: 100%;
  height: 40px;
  margin-top: -20px;
  z-index: 5;
}

/* Tag Flipped State */
.line-tag.flipped {
  transform: translate(-50%, 0) rotate(180deg);
  top: 6px; 
}

/* Magnifier */
.magnifier {
  position: absolute;
  width: 90px; 
  height: 90px;
  border-radius: 50%;
  border: 4px solid #fff;
  box-shadow: 0 4px 16px rgba(0,0,0,0.2);
  overflow: hidden;
  z-index: 9999;
  pointer-events: none;
  background-color: #f1f5f9; 
  margin-left: -45px;
  margin-top: -120px;
}

.magnifier::after {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 12px;
  height: 12px;
  transform: translate(-50%, -50%);
  background-color: rgba(59, 130, 246, 0.5); 
  border-radius: 50%;
  border: 2px solid #fff;
  z-index: 10;
}

/* Leader Line Styles */
.leader-diagonal {
  position: absolute;
  transform-origin: 0 50%;
  pointer-events: auto;
  box-shadow: 0 1px 3px rgba(0,0,0,0.15);
}

.leader-text-wrapper {
  position: absolute;
  pointer-events: none;
  display: flex;
}

.leader-tag {
  pointer-events: auto;
  white-space: nowrap;
  background-color: rgba(255, 255, 255, 0.95);
  color: #1e293b;
  padding: 2px 6px;
  border-radius: 4px;
  font-weight: 700;
  box-shadow: 0 4px 12px rgba(0,0,0,0.08);
  border: 1px solid rgba(0,0,0,0.05);
  transition: all 0.2s ease;
}

.leader-anchor-dot {
  position: absolute;
  border-radius: 50%;
  background-color: rgb(255 255 255 / 1);
  transform: translate(-50%, -50%);
  pointer-events: auto;
  box-shadow: 0 1px 3px rgba(0,0,0,0.15);
}

/* Updated UI Overlay */
.overlay-buttons {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.btn-leader {
  background-color: #3b82f6; 
  color: #fff;
  flex-direction: column;
  padding: 0; 
}

.magnifier-img {
  position: absolute;
  top: 0;
  left: 0;
  transform-origin: 0 0;
  will-change: transform;
}

/* Text Tag Styles */
.btn-text-tag, .btn-auto-tag {
  background-color: #3b82f6; 
  color: #fff;
  flex-direction: column;
  padding: 0; 
}

.text-tag-container {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
}

.text-tag-box {
  position: absolute;
  pointer-events: auto;
  font-weight: 700;
  word-wrap: break-word;
  overflow-wrap: break-word;
  display: flex;
  align-items: center;
  padding: 2px 4px;
  box-sizing: border-box;
  border-radius: 4px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  z-index: 10;
}

.text-tag-bg {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  border-radius: 4px;
  z-index: 0;
}

.text-tag-content {
  position: relative;
  z-index: 1;
  word-break: break-all;
  width: 100%;
  display: block;
  line-height: 1.4;
}

/* Auto Tag Styles */
.auto-tag-container {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
}

.auto-tag-box {
  position: absolute;
  pointer-events: auto;
  font-weight: 700;
  display: inline-block; /* Adaptive size */
  max-width: 200px;
  width: auto;
  height: auto;
  padding: 4px 4px; /* Inner Padding */
  box-sizing: border-box;
  /* background managed by inner layer */
  z-index: 10;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  border-radius: 4px;
}

.auto-tag-content {
  position: relative;
  z-index: 1;
  word-break: break-all;
  display: block;
  line-height: 1.2;
  min-width: 20px;
  min-height: 14px;
}

.auto-tag-dot {
  position: absolute;
  left: -15px; /* -4px (gap) - 11px (width) */
  top: 50%;
  width: 5px;
  height: 5px;
  background-color: #fff;
  border: 3px solid rgba(0, 0, 0, 0.8);
  border-radius: 50%;
  transform: translateY(-50%);
  z-index: 10;
}

.color-scroll-inline {
  flex: 1;
  display: flex;
  white-space: nowrap;
  height: 40px;
}

.opacity-value {
  color: #334155;
  font-size: 14px;
  font-weight: 600;
  min-width: 45px;
  text-align: center;
}

.align-toggle {
  display: flex;
  background-color: #e2e8f0;
  border-radius: 8px;
  padding: 3px;
  gap: 4px;
  flex: 1;
}

.align-btn {
  flex: 1;
  padding: 6px 8px;
  font-size: 13px;
  font-weight: 600;
  color: #64748b;
  border-radius: 6px;
  transition: all 0.2s ease;
  text-align: center;
}

.align-btn.active {
  background-color: #fff;
  color: #3b82f6;
  box-shadow: 0 1px 2px rgba(0,0,0,0.1);
}

.tool-section-full {
  display: flex;
  align-items: center;
  gap: 16px;
  width: 100%;
}

.tool-section-full .tool-label {
  flex-shrink: 0;
}

.tool-section-full .color-scroll {
  flex: 1;
}

